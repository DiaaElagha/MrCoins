@model Coins.Web.Models.ViewModels.StoreBranchVM

@{
    ViewData["Title"] = "اضافة فرع جديد";
}
<div class="kt-portlet kt-portlet--mobile">
    <div class="kt-portlet__body">
        <form asp-action="Create" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"> </div>
            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" asp-for="branchVM.BranchNameAr" class="form-control-label sm-bolder"></label>
                        <input asp-for="branchVM.BranchNameAr" class="form-control border-gray">
                        <span asp-validation-for="branchVM.BranchNameAr" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Latitude" asp-for="branchVM.BranchNameEn" class="form-control-label sm-bolder"></label>
                        <input asp-for="branchVM.BranchNameEn" class="form-control border-gray">
                        <span asp-validation-for="branchVM.BranchNameEn" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-2 text-center">
                    <div class="form-group">
                        <label for="Latitude" asp-for="branchVM.IsMainBranch" class="form-control-label sm-bolder"></label>
                        <br />
                        <span class="kt-switch kt-switch--outline kt-switch--icon kt-switch--brand">
                            <label>
                                <input type="checkbox" checked="checked" asp-for="branchVM.IsMainBranch">
                                <span></span>
                            </label>
                        </span>
                        <span asp-validation-for="branchVM.IsMainBranch" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" asp-for="branchVM.BranchDescriptionAr" class="form-control-label sm-bolder"></label>
                        <textarea asp-for="branchVM.BranchDescriptionAr" class="form-control border-gray" rows="3"></textarea>
                        <span asp-validation-for="branchVM.BranchDescriptionAr" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" asp-for="branchVM.BranchDescriptionEn" class="form-control-label sm-bolder"></label>
                        <textarea asp-for="branchVM.BranchDescriptionEn" class="form-control border-gray" rows="3"></textarea>
                        <span asp-validation-for="branchVM.BranchDescriptionEn" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" asp-for="AdvantagesList" class="form-control-label sm-bolder"></label>
                        <select asp-for="AdvantagesList" multiple asp-items="ViewBag.AdvantagesList" data-size="6" data-live-search="true" class="rounded selectpicker border-gray" data-width="100%">
                            <option value="">اختر المزايا</option>
                        </select>
                        <span asp-validation-for="AdvantagesList" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" class="form-control-label sm-bolder">ادخل الموقع</label>
                        <div class="input-group">
                            <input id="location" class="form-control border-gray" placeholder="ابحث عن مكان">
                            <input type="hidden" id="lat" asp-for="branchVM.BranchLatitudeLocation">
                            <input type="hidden" id="lng" asp-for="branchVM.BranchLongitudeLocation">
                            <div class="input-group-prepend ">
                                <button class="btn btn-outline-secondary rounded-right border-gray" type="button" data-toggle="collapse" href="#collapseMap" role="button" aria-expanded="false" aria-controls="collapseExample">
                                    <i class="fas fa-map-marker-alt fa-lg text-primary"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="collapse" id="collapseMap">
                        <div id="us2" style="height: 350px;"></div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Name" class="form-control-label sm-bolder">صورة الفرع الاساسية</label>
                        <input name="MainAttachment" type="file" class="form-control border-gray">
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="Attachments" class="form-control-label sm-bolder">صورة اضافية </label>
                        <input type="file" multiple name="Attachments" class="form-control border-gray">
                    </div>
                </div>
            </div>

            <a href="@Context.Request.Headers["Referer"].ToString()" class="rounded btn btn-secondary">رجوع</a>
            <button type="submit" class="rounded btn btn-primary">حفظ</button>
        </form>

        <!--<br />
        <hr />
        <div class="row pt-4">
            <div class="col-md-3">
                <h5 class="bolder">قائمة الموظفين</h5>
            </div>
            <div class="col-md-9 text-right">
                <a href="~/Cashers/Create" title="اضافة موظف جديد" class="PopUp bolder color-mrcoins">
                    <i class="la la-plus-circle fa-lg "></i>
                    إضافة موظف
                </a>
            </div>
        </div>
        <form class="DTForm">
            <div class="row">
                <div class="col-5">
                    <input class="form-control" type="search" placeholder="ابحث بالاسم  ..." name="SearchKey">
                </div>
            </div>
        </form>-->

        <!--begin: Datatable -->
        <!--<table class="table table-striped table-bordered table-hover table-checkable" id="dataTableId" style="text-align:center">
            <thead>
                <tr>
                    <th>الاسم</th>
                    <th>اسم المتسخدم</th>
                    <th>الفرع</th>
                    <th>الجنس</th>
                    <th>الحالة</th>
                    <th>التحديث</th>
                    <th> الانشاء والتعديل</th>
                    <th width="10%">العمليات</th>
                </tr>
            </thead>
        </table>-->

        <!--end: Datatable -->
    </div>
</div>


@section Scripts {
    <script>
        $('.selectpicker').selectpicker();
        PageLoadActions();
    </script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>

    @*<script>
        $(function () {
            $(".DTForm").submit(function () {
                dataSourceAjaxServer.init();
                return false;
            });
        });
        var dataSourceAjaxServer = function () {
            var initTable1 = function () {
                var table = $('#dataTableId');
                // begin first table
                table.DataTable({
                    language: {
                        emptyTable: "لا يوجد بيانات لعرضها", info: "عرض _START_ الى _END_ من _TOTAL_ صف", infoEmpty: "لا يوجد نتائج", infoFiltered: "(filtered1 من _MAX_ اجمالي صفوف)", lengthMenu: "_MENU_", search: "بحث", zeroRecords: "لا يوجد نتائج لعرضها"
                    },
                    responsive: true,
                    searchDelay: 500,
                    processing: true,
                    serverSide: true,
                    sPaginationType: "full_numbers",
                    bDestroy: true,
                    bSort: false,
                    bLengthChange: true,
                    dom:
                        "<'row'<'col-sm-12'tr>>" +
                        "<'row'<'col-sm-4'i><'col-sm-4 text-center'l><'col-sm-4'p>>",
                    ajax: {
                        type: "POST",
                        contentType: "application/json",
                        url: '@Url.Action("AjaxData", "Cashers")',
                        data: function (d) {
                            d.SearchKey = ($("[name=SearchKey]").val());
                            return JSON.stringify(d);
                        }
                    },
                    columns: [
                        { data: 'FullName' },
                        { data: 'UserName' },
                        { data: 'BranchName' },
                        { data: 'Gender' },
                        {
                            "render": function (data, type, row) {
                                if (row["IsActive"]) {
                                    return '<span style="font-size: 13px;" class="label label-sm text-white rounded label-primary bg-success label-inline font-weight-bold pr-2 pl-2">فعال</span>';
                                }
                                return '<span style="font-size: 13px;" class="label label-sm text-white rounded label-primary bg-danger label-inline font-weight-bold pr-2 pl-2">معطل</span>';
                            }
                        },
                        {
                            "render": function (data, type, row) {
                                var resultD = "";
                                resultD += "<small class='text-primary'>اخر تسجيل : </small>" + row["LastLoginTime"] + " <br />";
                                resultD += "<small class='text-primary'>تاريخ الانتهاء : </small>" + row["ExpiryDate"] + " <br />";
                                return resultD;
                            }
                        },
                        {
                            "render": function (data, type, row) {
                                var resultD = "";
                                resultD += "<small class='text-primary'>تاريخ الانشاء : </small>" + row["InsertDate"] + " <br />";
                                resultD += "<small class='text-primary'>اخر تعديل : </small>" + row["UpdateDate"];
                                return resultD;
                            }
                        },
                        { data: 'Actions', responsivePriority: -1 },
                    ],
                    columnDefs: [
                        {
                            targets: -1,
                            orderable: false,
                            render: function (data, type, row, meta) {
                                return ''
                                    + '<span class="dropdown">'
                                    + '<a href="#" class="btn btn-sm btn-clean btn-icon btn-icon-md" data-toggle="dropdown" aria-expanded="true">'
                                    + '<i class="la la-ellipsis-h"></i></a>'
                                    + '<div class="dropdown-menu dropdown-menu-right">'
                                    + '<a class="Confirm dropdown-item text-danger" tname="#dataTableId" href="@Url.Action("Delete", "Cashers")/' + row["Id"] + '"><i class="la la-trash text-danger"></i> حذف الموظف</a>'
                                    + '</div></span>'
                                    + '<a href="@Url.Action("Edit", "Cashers")/' + row["Id"] + '" title="تعديل الموظف" class="PopUp btn btn-sm btn-clean btn-icon btn-icon-md"><i class="la la-edit"></i></a>';
                            },
                        }
                    ],
                });
            };

            return {
                init: function () {
                    initTable1();
                },
            };
        }();
        jQuery(document).ready(function () {
            dataSourceAjaxServer.init();
        });


    </script>*@


    <script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false&libraries=places"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCF7FxGIIn8R68D57MPpVvuKvwfY6YoPL0&callback=initMap"></script>
    <script src="~/js/locationpicker.jquery.js"></script>
    <script>
        $(function () {
            $('#us2').locationpicker({
                location: { latitude: 46.15242437752303, longitude: 2.7470703125 },
                radius: 0,
                inputBinding: {
                    latitudeInput: $('#lat'),
                    longitudeInput: $('#lng'),
                    locationNameInput: $('#location')
                },
                enableAutocomplete: true,
                onchanged: function (currentLocation, radius, isMarkerDropped) {
                    alert("Location changed. New location (" + currentLocation.latitude + ", " + currentLocation.longitude + ")");
                }
            });
        });
    </script>
}

